{% extends 'base.html' %}

{% block content %}
<h1>Create New Order</h1>

<form method="POST">
    {% csrf_token %}

    <!-- Render the form fields for the client -->
    {{ form.as_p }}

    <!-- Product Selection -->
    <h3>Select Products</h3>
    <div>
        {% for product in products %}
        <div style="margin-bottom: 10px;">
            {% if product.stock_quantity > 0 %}
            <!-- Product Available -->
            <input type="checkbox" id="product_{{ product.id }}" name="product" value="{{ product.id }}">
            <label for="product_{{ product.id }}">{{ product.name }} - ${{ product.price }} ({{ product.stock_quantity }} in stock)</label>
            <br>
            <label for="quantity_{{ product.id }}">Quantity:</label>
            <input type="number" id="quantity_{{ product.id }}" name="quantity_{{ product.id }}" value="1" min="1" max="{{ product.stock_quantity }}">
            {% else %}
            <!-- Product Out of Stock -->
            <input type="checkbox" id="product_{{ product.id }}" name="product" value="{{ product.id }}" disabled>
            <label for="product_{{ product.id }}" style="color: gray;">
                {{ product.name }} - ${{ product.price }} (Out of Stock)
            </label>
            {% endif %}
        </div>
        {% endfor %}
    </div>

    <!-- Discount Selection -->
    <h3>Select Discount (Optional)</h3>
    <div>
        <label for="discount">Discount:</label>
        <select name="discount" id="discount">
            {% for key, value in discount_choices %}
            <option value="{{ key }}">{{ value }}</option>
            {% endfor %}
        </select>
    </div>

    <!-- Submit Button -->
    <button type="submit" style="margin-top: 20px;">Create Order</button>
</form>
{% endblock %}
